const topic=document.getElementById("topic"),coursename=document.getElementById("coursename"),sname=document.getElementById("sname"),tname=document.getElementById("tname"),roll=document.getElementById("roll"),subdate=document.getElementById("subdate"),section=document.getElementById("section"),designation=document.getElementById("designation"),department=document.getElementById("department"),download=document.getElementById("download"),canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");let img=new Image;function drawImageWithText(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(img,0,0);let e=1880,t=3220;ctx.measureText(department.value).width>700&&(e=1310,t=3300);const n=[{text:topic.value,x:950,y:1960,maxWidth:1400,wrap:!0,lineHeight:72},{text:coursename.value,x:950,y:2330},{text:sname.value,x:600,y:2900,maxWidth:630,wrap:!0,lineHeight:72},{text:tname.value,x:1630,y:2900,maxWidth:790,wrap:!0,lineHeight:72},{text:formatDate(subdate.value),x:950,y:2460},{text:roll.value,x:600,y:3095},{text:section.value,x:600,y:3220},{text:designation.value,x:1880,y:3095,maxWidth:500,wrap:!0,lineHeight:60},{text:department.value,x:e,y:t,maxWidth:1500,wrap:!0,lineHeight:60}];ctx.font="normal 72px Arial",ctx.fillStyle="black",ctx.textAlign="left",n.forEach((({text:e,x:t,y:n,maxWidth:a,wrap:i,lineHeight:l})=>{e&&(i?wrapText(ctx,e,t,n,a,l):ctx.fillText(e,t,n))})),download.style.display="block"}function formatDate(e){if(!e)return"";let t=e.split("-");return`${t[2]}-${t[1]}-${t[0]}`}function wrapText(e,t,n,a,i,l){let d=t.split(" "),m="",o=[];for(let t=0;t<d.length;t++){let n=m+(m?" ":"")+d[t];e.measureText(n).width>i&&""!==m?(o.push(m),m=d[t]):m=n}o.push(m);for(let t=0;t<o.length;t++)e.fillText(o[t],n,a+t*l)}img.src="./cover.png",img.onload=function(){canvas.width=img.width,canvas.height=img.height,drawImageWithText()},[topic,coursename,sname,tname,subdate,roll,section,designation,department].forEach((e=>{e.addEventListener("input",drawImageWithText)})),download.addEventListener("click",(function(){const e=document.createElement("a");e.download="custom_image.png",e.href=canvas.toDataURL("image/png"),e.click()}));
