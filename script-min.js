const topic=document.getElementById("topic"),coursename=document.getElementById("coursename"),sname=document.getElementById("sname"),tname=document.getElementById("tname"),roll=document.getElementById("roll"),subdate=document.getElementById("subdate"),section=document.getElementById("section"),designation=document.getElementById("designation"),department=document.getElementById("department"),download=document.getElementById("download"),canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");let img=new Image;function drawImageWithText(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(img,0,0);let e=[{text:topic.value,x:950,y:1960,maxWidth:1400,wrap:!0,lineHeight:72},{text:coursename.value,x:950,y:2330},{text:sname.value,x:600,y:2900,maxWidth:630,wrap:!0,lineHeight:72},{text:tname.value,x:1630,y:2900,maxWidth:790,wrap:!0,lineHeight:72},{text:formatDate(subdate.value),x:950,y:2460},{text:roll.value,x:600,y:3095},{text:section.value,x:600,y:3220},{text:designation.value,x:1880,y:3095,maxWidth:500,wrap:!0,lineHeight:60},{text:department.value,x:1880,y:3220,maxWidth:550,wrap:!0,lineHeight:60}];ctx.font="normal 72px Arial",ctx.fillStyle="black",ctx.textAlign="left",e.forEach(({text:e,x:t,y:a,maxWidth:n,wrap:l,lineHeight:i})=>{e&&(l?wrapText(ctx,e,t,a,n,i):ctx.fillText(e,t,a))}),download.style.display="block"}function formatDate(e){if(!e)return"";let t=e.split("-");return`${t[2]}-${t[1]}-${t[0]}`}function wrapText(e,t,a,n,l,i){let d=t.split(" "),o="",m=[];for(let c=0;c<d.length;c++){let $=o+(o?" ":"")+d[c];e.measureText($).width>l&&""!==o?(m.push(o),o=d[c]):o=$}m.push(o);for(let r=0;r<m.length;r++)e.fillText(m[r],a,n+r*i)}img.src="./cover.png",img.onload=function(){canvas.width=img.width,canvas.height=img.height,drawImageWithText()},[topic,coursename,sname,tname,subdate,roll,section,designation,department].forEach(e=>{e.addEventListener("input",drawImageWithText)}),download.addEventListener("click",function(){let e=document.createElement("a");e.download="custom_image.png",e.href=canvas.toDataURL("image/png"),e.click()});